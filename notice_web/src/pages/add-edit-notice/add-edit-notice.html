<ion-header no-border no-shadow style="height: 40px;">
    <div class="page-back">
        <button (click)="goBack()">< 返回</button>
    </div>
</ion-header>
<ion-content>
    <div class="default-div">
        <ion-item no-lines (click)="displayAddUser()">
            <ion-label>接收人:
                <span *ngIf='selectedNum' class="recive">人员去重后已选择{{selectedNum||''}}人<!--<span *ngIf='selectedDept'>，其中有{{selectedDept||''}}个机构（含子机构）</span>--></span>
            </ion-label>
            <!-- <ion-input type="text" readonly=true text-right placeholder=""></ion-input> -->
            <!--  <ion-chip #chip1 class="chip" *ngFor="let user of notice.RECEIVEOBJECTS">
            <ion-label>{{user.NAME}}</ion-label>
            <button ion-button clear (click)="delete(user.NAME)">
                <ion-icon name="close" class="delete" ></ion-icon>
            </button>
        </ion-chip> -->

            <button item-end *ngIf='!selectedNum'>
            <!--<ion-icon name="add-circle" color="primary" ></ion-icon>-->
           <img src="assets/image/建组@1x.png">
        </button>
        </ion-item>
    </div>
    <div class="selectoptions" [hidden]="!add" style="display: flex;">
        <div style="flex: 1; border: 1px solid #e5e5e5;">
            <ion-scroll scrollY="true" style="height:80vh;">

                <!--<ion-list>
                    <ion-item *ngFor="let item of departmentUnion.UnionMap.entries(); var i = index">
                        {{item[0]}} {{item[1].REALNAME}}
                    </ion-item>
                </ion-list>
                <ion-list>
                    <ion-item *ngFor="let item of groupUnion.UnionMap.entries(); var i = index">
                        {{item[0]}} {{item[1].REALNAME}}
                    </ion-item>
                </ion-list>-->
                <!--<ion-list *ngIf="friendUnion.MemberMap != undefined">-->
                <!--<div>{{friendUnions?.MemberMap|json}}</div>-->

                <ion-item style="background-color: #ffffff;">
                    <ion-label class="newGroupTitle">我的群组</ion-label>
                    <button ion-button clear item-right icon-left (click)="tiggerShowChatGroupList()">
              <ion-icon [name]="showChatGroupList ? 'arrow-dropdown' : 'arrow-dropright'"></ion-icon>
          </button>
                </ion-item>
                <!--<ion-list>
                    <ion-item *ngFor="let item of groupUnion.UnionMap.entries(); let i = index">
                        <ion-label class="newGroupList">
                            {{item[0]}}
                        </ion-label>
                        <ion-checkbox></ion-checkbox>
                    </ion-item>
                </ion-list>-->
                <!--<ion-list *ngIf="showChatGroupList">
                    <ion-item-group *ngFor="let chatGroup of chatGroupList">
                        <ion-item-divider style="padding-left: 10px; background-color: #ffffff;">
                            <ion-checkbox style="margin-left: 20px;" [(ngModel)]="chatGroup.CHECKED" (ionChange)="chatGroupMemberListCheckChanged(chatGroup)"></ion-checkbox>
                            <ion-label class="newGroupList">{{ chatGroup.GroupName }}</ion-label>
                            <button id={{chatGroup.GroupID}} ion-button clear item-right icon-left (click)="tiggerShowChatGroupMemberList(chatGroup)">
                  <ion-icon [name]="chatGroup.SPREADED ? 'arrow-dropdown' : 'arrow-dropright'"></ion-icon>
              </button>
                        </ion-item-divider>
                        <ion-list *ngIf="chatGroup.SPREADED" item-content style="margin-left: 20px;">
                            <ion-item *ngFor="let groupMember of chatGroupMemberMap.get(chatGroup.GroupID) | stateFilter:[0, 1]">
                                <ion-checkbox [(ngModel)]="groupMember.CHECKED" (ionChange)="leftMemberCheckedChanged(groupMember)"></ion-checkbox>
                                <ion-label class="groupMember">{{groupMember.REALNAME}} <br>
                                    <!--<p>{{ groupMember.DEPTNAME }}</p>-->
                <!--</ion-label>
                            </ion-item>

                        </ion-list>
                    </ion-item-group>
                </ion-list>-->

                <ion-item style="background-color: #ffffff;">
                    <ion-label class="newGroupTitle">我的好友</ion-label>
                    <button ion-button clear item-right icon-left (click)="tiggerShowChatFriendList()">
            <ion-icon [name]="showChatFriendList ? 'arrow-dropdown' : 'arrow-dropright'"></ion-icon>
          </button>
                </ion-item>

                <ion-list *ngIf="friendUnions?.MemberMap">
                    <ion-item *ngFor="let item of friendUnions.MemberMap.entries(); let i = index">
                        <ion-label class="newGroupList">
                            {{item[1].REALNAME}}
                        </ion-label>
                        <ion-checkbox></ion-checkbox>
                    </ion-item>
                </ion-list>

                <!--<ion-list *ngIf="showChatFriendList" style="margin-left: 10px;">
                    <ion-item *ngFor="let chatFriend of chatFriendList | stateFilter:[0, 1]">
                        <ion-label class="newGroupList">{{ chatFriend.REALNAME }} <br>
                          
                        </ion-label>
                        <ion-checkbox [(ngModel)]="chatFriend.CHECKED" (ionChange)="leftMemberCheckedChanged(chatFriend)"></ion-checkbox>
                    </ion-item>
                </ion-list>-->


                <!--<ion-list *ngIf="friendUnions?.MemberMap">
                    <ion-item *ngFor="let item of friendUnions.MemberMap.entries(); let i = index">
                        {{item[1].REALNAME}}
                    </ion-item>
                </ion-list>-->
                <!--<div>{{friendUnion[0]['REALNAME']}}</div>-->
                <!--<ion-item *ngFor="let item of friendUnion; ">
                         {{item.REALNAME}}
                    </ion-item>-->
            </ion-scroll>

        </div>

        <div style="flex: 1; border: 1px solid #e5e5e5;">
            <ion-scroll scrollY="true" style="height:80vh;">
                <ion-label style="margin-left: 10px;">已选择联系人</ion-label>
                <div style="background-color: #e5e5e5; height: 5px; width: 100%;"></div>

                <ion-list>
                    <ion-item *ngFor="let groupMember of groupMemberToAddList  | stateFilter:[2, 3]">
                        <ion-checkbox [(ngModel)]="groupMember.CHECKED" (ionChange)="rightMemberCheckedChanged(groupMember)"></ion-checkbox>
                        <ion-label>{{ groupMember.REALNAME }} <br>
                            <!--<p>{{ groupMember.DEPTNAME }}-->
                        </ion-label>
                    </ion-item>
                </ion-list>
            </ion-scroll>


            <div class="endBtn">

                <button class="button1" (click)="goBack()">取消</button>
                <button class="button2" (click)="saveGroup()">确定</button>
            </div>
            <!--</ion-footer>-->
        </div>


    </div>
    <!--<HR class="separate">-->
    <div class="default-div-border">
        <div class="fileUpload">
            <img src="assets/image/附件.png" />
            <span>附件上传</span>
            <input #fileUpload type="file" class="upload" (change)="upload()" />
        </div>
        <div class="editTitle">
            <input type="text" [(ngModel)]="notice.MUSTTITLE" placeholder="题目" />
        </div>

    </div>

    <div class="default-div-border" [hidden]="notice.ATTACHMENTS.length === 0 ? true : false">
        <ion-list>
            <ion-item *ngFor="let attachment of notice.ATTACHMENTS">
                <img width="40" height="40" [src]="attachment.FileName | fileNameToTypeImageUrl" style="float: left;margin-right: 10px;" />
                <h2>{{attachment.FileName}}</h2>
                <p>{{attachment.FileSize | toReadableSize}}</p>
                <ion-avatar item-right>
                    <a href='/{{attachment.FileLink}}' download><img src="assets/image/下载.png"></a>
                </ion-avatar>
            </ion-item>
        </ion-list>
    </div>

    <div class="contentDiv">
        <div id="editor"></div>
    </div>

    <div class="parent">
        <select [(ngModel)]="notice.DEPARTMENT" class="parentUnit">
            <option value="" disabled selected>发送单位</option>
            <option *ngFor="let department of departmentList" value = "{{department.DEPTCODE}}">{{department.DEPTNAME}}</option>
        </select>
    </div>
    <!--<HR class="separate">-->

    <div class="date-div">
        <span>有效期至:</span>
        <app-ant-date-picker [(dateString)]="notice.VALIDTIME" [dateStyle]="'yyyyMMdd'"></app-ant-date-picker>
    </div>

    <!--<input [disabled]="!(bb.checked)" type="datetime-local" [(ngModel)]="notice.REMINDTIME" />-->

    <div class="tip2">* 到达有效期后，将会从通知列表中删除</div>

    <div class="time-check"><input #bb type="checkbox" (change)="remindCheckChanged(bb.checked)" /><label>&nbsp;&nbsp;特定时间提醒我</label></div>
    <div class="datetime-div" [hidden]="!bb.checked">
        <label>提醒时间:</label>
        <app-ant-date-picker   [(dateString)]="notice.REMINDTIME" [dateStyle]="'yyyyMMddhhmm'"></app-ant-date-picker>
    </div>
    <br>
    <br>
    <br>
    <br>
</ion-content>
<ion-footer style="height: 50px;">
    <div class="button-div">
        <button class="button1" (click)="saveNotice()">保存</button>
        <button class="button2" (click)="gotoPreview()">预览</button>
    </div>
</ion-footer>