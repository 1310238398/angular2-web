webpackJsonp([0],{240:function(t,n,e){"use strict";function i(t){return s["ɵvid"](0,[(t()(),s["ɵeld"](0,0,null,null,0,"canvas",[],null,null,null,null,null))],null,null)}function o(t){return s["ɵvid"](0,[(t()(),s["ɵeld"](0,0,null,null,1,"p",[["class","tips"]],null,null,null,null,null)),(t()(),s["ɵted"](-1,null,["请用正楷在此书写您的姓名，请尽量占满屏幕"]))],null,null)}function a(t){return s["ɵvid"](0,[s["ɵqud"](402653184,1,{signaturePad:0}),(t()(),s["ɵeld"](1,0,null,null,21,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,x.b,x.a)),s["ɵdid"](2,4374528,null,0,E.a,[b.a,C.a,D.a,s.ElementRef,s.Renderer,k.a,M.a,s.NgZone,[2,T.a],[2,S.a]],null,null),(t()(),s["ɵted"](-1,1,["\n    "])),(t()(),s["ɵeld"](4,0,null,1,17,"div",[["class","sign"]],null,null,null,null,null)),(t()(),s["ɵted"](-1,null,["\n      "])),(t()(),s["ɵand"](16777216,null,null,1,null,o)),s["ɵdid"](7,16384,null,0,B.i,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),s["ɵted"](-1,null,["\n      "])),(t()(),s["ɵeld"](9,0,null,null,1,"signature-pad",[],null,[[null,"onBeginEvent"],[null,"onEndEvent"]],function(t,n,e){var i=!0,o=t.component;if("onBeginEvent"===n){i=!1!==o.drawStart()&&i}if("onEndEvent"===n){i=!1!==o.drawComplete()&&i}return i},i,R)),s["ɵdid"](10,1097728,[[1,4]],0,r.SignaturePad,[s.ElementRef],{options:[0,"options"]},{onBeginEvent:"onBeginEvent",onEndEvent:"onEndEvent"}),(t()(),s["ɵted"](-1,null,["\n      "])),(t()(),s["ɵeld"](12,0,null,null,8,"div",[["class","sign-btn"]],null,null,null,null,null)),(t()(),s["ɵted"](-1,null,["\n          "])),(t()(),s["ɵted"](-1,null,["\n        "])),(t()(),s["ɵeld"](15,0,null,null,1,"button",[["class","btn"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],function(t,n,e){var i=!0;if("click"===n){i=!1!==t.component.savePad()&&i}return i},null,null)),(t()(),s["ɵted"](-1,null,["确定"])),(t()(),s["ɵted"](-1,null,["\n        "])),(t()(),s["ɵeld"](18,0,null,null,1,"button",[["class","btn btn-cancle margin-t-35"],["type","button"]],[[8,"disabled",0]],[[null,"click"]],function(t,n,e){var i=!0;if("click"===n){i=!1!==t.component.clearPad()&&i}return i},null,null)),(t()(),s["ɵted"](-1,null,["清空"])),(t()(),s["ɵted"](-1,null,["\n      "])),(t()(),s["ɵted"](-1,null,["\n    "])),(t()(),s["ɵted"](-1,1,["\n  "]))],function(t,n){var e=n.component;t(n,7,0,!e.isDrawing);t(n,10,0,e.signaturePadOptions)},function(t,n){var e=n.component;t(n,1,0,s["ɵnov"](n,2).statusbarPadding,s["ɵnov"](n,2)._hasRefresher);t(n,15,0,!e.isDrawing);t(n,18,0,!e.isDrawing)})}Object.defineProperty(n,"__esModule",{value:!0});var s=e(0),r=(e(7),e(107),e(244)),l=e(108),u=e(195),h=function(){function t(t,n){this.navCtrl=t,this.http=n,this.itemsSrc="",this.nowTime="",this.commitmentID="",this.signature="",this.isDrawing=!1,this.show=!1,this.signaturePadOptions={minWidth:2,canvasWidth:100,canvasHeight:100,backgroundColor:"#ffffff",penColor:"#3e3e3e",placeholder:"请签字"}}return t.prototype.ionViewWillEnter=function(){var t=this;antlinker.configTitle({type:"label",title:"请签字",fail:function(){},success:function(){}}),antlinker.configTitleButton({type:"close",text:"关闭",fail:function(){},success:function(){},trigger:function(){}}),window.addEventListener("resize",function(){setTimeout(function(){t.signaturePad.resizeCanvas()},1e3),t.signaturePad.resizeCanvas()}),antlinker.changeOrientation({orientation:"landscape",success:function(){},fail:function(){}})},t.prototype.ionViewDidLeave=function(){antlinker.changeOrientation({orientation:"portrait",success:function(){console.log("竖屏 portrait")},fail:function(){}})},t.prototype.drawComplete=function(){},t.prototype.drawStart=function(){this.isDrawing=!0},t.prototype.savePad=function(){var t=this;this.signature=this.signaturePad.toDataURL(),this.http.postJSON({Router:u.a.Url.saveattach,Method:"POST",Body:{BizType:"StudentNeedSupportSign",AttachmentItemName:"",AttachmentItemType:"",AttachmentItemSize:"",AttachmentURL:"",Base64:this.signature}}).then(function(n){n.FeedbackCode||(antlinker.changeOrientation({orientation:"portrait",success:function(){},fail:function(){}}),t.navCtrl.push("PromiseBookOnePage",{bTest:"1"}))},function(t){return alert(t)})},t.prototype.clearPad=function(){this.signaturePad.clear(),this.isDrawing=!1},t}(),c=e(245),d=function(){return function(){}}(),p=e(186),v=e(187),f=e(188),m=e(189),g=e(190),y=e(191),_=e(192),w=e(193),P=e(194),x=e(243),E=e(21),b=e(1),C=e(3),D=e(9),k=e(8),M=e(34),T=e(4),S=e(20),B=e(13),R=s["ɵcrt"]({encapsulation:2,styles:[],data:{}}),L=s["ɵcrt"]({encapsulation:2,styles:[],data:{}}),W=s["ɵccf"]("promisebooktwo",h,function(t){return s["ɵvid"](0,[(t()(),s["ɵeld"](0,0,null,null,1,"promisebooktwo",[],null,null,null,a,L)),s["ɵdid"](1,49152,null,0,h,[S.a,l.a],null,null)],null,null)},{},{},[]),A=e(16),F=e(110),N=e(35);e.d(n,"PromiseBookTwoModuleNgFactory",function(){return U});var U=s["ɵcmf"](d,[],function(t){return s["ɵmod"]([s["ɵmpd"](512,s.ComponentFactoryResolver,s["ɵCodegenComponentFactoryResolver"],[[8,[p.a,v.a,f.a,m.a,g.a,y.a,_.a,w.a,P.a,W]],[3,s.ComponentFactoryResolver],s.NgModuleRef]),s["ɵmpd"](4608,B.k,B.j,[s.LOCALE_ID,[2,B.s]]),s["ɵmpd"](4608,A.m,A.m,[]),s["ɵmpd"](4608,A.c,A.c,[]),s["ɵmpd"](512,c.SignaturePadModule,c.SignaturePadModule,[]),s["ɵmpd"](512,B.b,B.b,[]),s["ɵmpd"](512,A.l,A.l,[]),s["ɵmpd"](512,A.d,A.d,[]),s["ɵmpd"](512,A.k,A.k,[]),s["ɵmpd"](512,F.a,F.a,[]),s["ɵmpd"](512,F.b,F.b,[]),s["ɵmpd"](512,d,d,[]),s["ɵmpd"](256,N.a,h,[])])})},243:function(t,n,e){"use strict";function i(t){return o["ɵvid"](2,[o["ɵqud"](402653184,1,{_fixedContent:0}),o["ɵqud"](402653184,2,{_scrollContent:0}),(t()(),o["ɵeld"](2,0,[[1,0],["fixedContent",1]],null,1,"div",[["class","fixed-content"]],null,null,null,null,null)),o["ɵncd"](null,0),(t()(),o["ɵeld"](4,0,[[2,0],["scrollContent",1]],null,1,"div",[["class","scroll-content"]],null,null,null,null,null)),o["ɵncd"](null,1),o["ɵncd"](null,2)],null,null)}e.d(n,"a",function(){return a}),n.b=i;var o=e(0),a=(e(1),e(3),e(9),e(34),e(4),e(20),o["ɵcrt"]({encapsulation:2,styles:[],data:{}}))},244:function(t,n,e){"use strict";var i=e(0);n.SignaturePad=function(){function t(t){this.elementRef=t,this.options=this.options||{},this.onBeginEvent=new i.EventEmitter,this.onEndEvent=new i.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=e(246).default,n=this.elementRef.nativeElement.querySelector("canvas");this.options.canvasHeight&&(n.height=this.options.canvasHeight),this.options.canvasWidth&&(n.width=this.options.canvasWidth),this.signaturePad=new t(n,this.options),this.signaturePad.onBegin=this.onBegin.bind(this),this.signaturePad.onEnd=this.onEnd.bind(this)},t.prototype.resizeCanvas=function(){var t=Math.max(window.devicePixelRatio||1,1),n=this.signaturePad._canvas;n.width=n.offsetWidth*t,n.height=n.offsetHeight*t,n.getContext("2d").scale(t,t),this.signaturePad.clear()},t.prototype.toData=function(){return this.signaturePad.toData()},t.prototype.fromData=function(t){this.signaturePad.fromData(t)},t.prototype.toDataURL=function(t,n){return this.signaturePad.toDataURL(t,n)},t.prototype.fromDataURL=function(t,n){void 0===n&&(n={}),this.signaturePad.fromDataURL(t,n)},t.prototype.clear=function(){this.signaturePad.clear()},t.prototype.isEmpty=function(){return this.signaturePad.isEmpty()},t.prototype.off=function(){this.signaturePad.off()},t.prototype.on=function(){this.signaturePad.on()},t.prototype.set=function(t,n){switch(t){case"canvasHeight":this.signaturePad._canvas.height=n;break;case"canvasWidth":this.signaturePad._canvas.width=n;break;default:this.signaturePad[t]=n}},t.prototype.onBegin=function(){this.onBeginEvent.emit(!0)},t.prototype.onEnd=function(){this.onEndEvent.emit(!0)},t.decorators=[{type:i.Component,args:[{template:"<canvas></canvas>",selector:"signature-pad"}]}],t.ctorParameters=[{type:i.ElementRef}],t.propDecorators={options:[{type:i.Input}],onBeginEvent:[{type:i.Output}],onEndEvent:[{type:i.Output}]},t}()},245:function(t,n,e){"use strict";var i=e(0),o=e(244);n.SignaturePadModule=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{imports:[],declarations:[o.SignaturePad],exports:[o.SignaturePad]}]}],t.ctorParameters=[],t}()},246:function(t,n,e){"use strict";function i(t,n,e){this.x=t,this.y=n,this.time=e||(new Date).getTime()}function o(t,n,e,i){this.startPoint=t,this.control1=n,this.control2=e,this.endPoint=i}function a(t,n){var e=this,i=n||{};this.velocityFilterWeight=i.velocityFilterWeight||.7,this.minWidth=i.minWidth||.5,this.maxWidth=i.maxWidth||2.5,this.throttle="throttle"in i?i.throttle:16,this.minDistance="minDistance"in i?i.minDistance:5,this._strokeMoveUpdate=this.throttle?function(t,n,e){var i,o,a,s=null,r=0;e||(e={});var l=function(){r=!1===e.leading?0:Date.now(),s=null,a=t.apply(i,o),s||(i=o=null)};return function(){var u=Date.now();r||!1!==e.leading||(r=u);var h=n-(u-r);return i=this,o=arguments,h<=0||h>n?(s&&(clearTimeout(s),s=null),r=u,a=t.apply(i,o),s||(i=o=null)):s||!1===e.trailing||(s=setTimeout(l,h)),a}}(a.prototype._strokeUpdate,this.throttle):a.prototype._strokeUpdate,this.dotSize=i.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=i.penColor||"black",this.backgroundColor=i.backgroundColor||"rgba(0,0,0,0)",this.onBegin=i.onBegin,this.onEnd=i.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(e._mouseButtonDown=!0,e._strokeBegin(t))},this._handleMouseMove=function(t){e._mouseButtonDown&&e._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&e._mouseButtonDown&&(e._mouseButtonDown=!1,e._strokeEnd(t))},this._handleTouchStart=function(t){if(1===t.targetTouches.length){e._strokeBegin(t.changedTouches[0])}},this._handleTouchMove=function(t){t.preventDefault();e._strokeMoveUpdate(t.targetTouches[0])},this._handleTouchEnd=function(t){t.target===e._canvas&&(t.preventDefault(),e._strokeEnd(t))},this.on()}Object.defineProperty(n,"__esModule",{value:!0}),i.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},i.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},o.prototype.length=function(){for(var t=0,n=void 0,e=void 0,i=0;i<=10;i+=1){var o=i/10,a=this._point(o,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),s=this._point(o,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){var r=a-n,l=s-e;t+=Math.sqrt(r*r+l*l)}n=a,e=s}return t},o.prototype._point=function(t,n,e,i,o){return n*(1-t)*(1-t)*(1-t)+3*e*(1-t)*(1-t)*t+3*i*(1-t)*t*t+o*t*t*t},a.prototype.clear=function(){var t=this._ctx,n=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,n.width,n.height),t.fillRect(0,0,n.width,n.height),this._data=[],this._reset(),this._isEmpty=!0},a.prototype.fromDataURL=function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new Image,o=e.ratio||window.devicePixelRatio||1,a=e.width||this._canvas.width/o,s=e.height||this._canvas.height/o;this._reset(),i.src=t,i.onload=function(){n._ctx.drawImage(i,0,0,a,s)},this._isEmpty=!1},a.prototype.toDataURL=function(t){var n;switch(t){case"image/svg+xml":return this._toSVG();default:for(var e=arguments.length,i=Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];return(n=this._canvas).toDataURL.apply(n,[t].concat(i))}},a.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},a.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},a.prototype.isEmpty=function(){return this._isEmpty},a.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"==typeof this.onBegin&&this.onBegin(t)},a.prototype._strokeUpdate=function(t){var n=this._createPoint(t.clientX,t.clientY),e=this._data[this._data.length-1],i=e&&e[e.length-1],o=i&&n.distanceTo(i)<this.minDistance;if(!i||!o){var a=this._addPoint(n),s=a.curve,r=a.widths;s&&r&&this._drawCurve(s,r.start,r.end),this._data[this._data.length-1].push({x:n.x,y:n.y,time:n.time,color:this.penColor})}},a.prototype._strokeEnd=function(t){var n=this.points[0];if(!(this.points.length>2)&&n&&this._drawDot(n),n){var e=this._data[this._data.length-1];n.equals(e[e.length-1])||e.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}"function"==typeof this.onEnd&&this.onEnd(t)},a.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},a.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},a.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},a.prototype._createPoint=function(t,n,e){var o=this._canvas.getBoundingClientRect();return new i(t-o.left,n-o.top,e||(new Date).getTime())},a.prototype._addPoint=function(t){var n=this.points,e=void 0;if(n.push(t),n.length>2){3===n.length&&n.unshift(n[0]);var i=(e=this._calculateCurveControlPoints(n[0],n[1],n[2])).c2;e=this._calculateCurveControlPoints(n[1],n[2],n[3]);var a=new o(n[1],i,e.c1,n[2]),s=this._calculateCurveWidths(a);return n.shift(),{curve:a,widths:s}}return{}},a.prototype._calculateCurveControlPoints=function(t,n,e){var o=t.x-n.x,a=t.y-n.y,s=n.x-e.x,r=n.y-e.y,l=(t.x+n.x)/2,u=(t.y+n.y)/2,h=(n.x+e.x)/2,c=(n.y+e.y)/2,d=Math.sqrt(o*o+a*a),p=Math.sqrt(s*s+r*r),v=p/(d+p),f=n.x-(h+(l-h)*v),m=n.y-(c+(u-c)*v);return{c1:new i(l+f,u+m),c2:new i(h+f,c+m)}},a.prototype._calculateCurveWidths=function(t){var n={start:null,end:null},e=this.velocityFilterWeight*t.endPoint.velocityFrom(t.startPoint)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(e);return n.start=this._lastWidth,n.end=i,this._lastVelocity=e,this._lastWidth=i,n},a.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},a.prototype._drawPoint=function(t,n,e){var i=this._ctx;i.moveTo(t,n),i.arc(t,n,e,0,2*Math.PI,!1),this._isEmpty=!1},a.prototype._drawCurve=function(t,n,e){var i=this._ctx,o=e-n,a=Math.floor(t.length());i.beginPath();for(var s=0;s<a;s+=1){var r=s/a,l=r*r,u=l*r,h=1-r,c=h*h,d=c*h,p=d*t.startPoint.x;p+=3*c*r*t.control1.x,p+=3*h*l*t.control2.x;var v=d*t.startPoint.y;v+=3*c*r*t.control1.y,v+=3*h*l*t.control2.y;this._drawPoint(p+=u*t.endPoint.x,v+=u*t.endPoint.y,n+u*o)}i.closePath(),i.fill()},a.prototype._drawDot=function(t){var n=this._ctx,e="function"==typeof this.dotSize?this.dotSize():this.dotSize;n.beginPath(),this._drawPoint(t.x,t.y,e),n.closePath(),n.fill()},a.prototype._fromData=function(t,n,e){for(var o=0;o<t.length;o+=1){var a=t[o];if(a.length>1)for(var s=0;s<a.length;s+=1){var r=a[s],l=new i(r.x,r.y,r.time),u=r.color;if(0===s)this.penColor=u,this._reset(),this._addPoint(l);else if(s!==a.length-1){var h=this._addPoint(l),c=h.curve,d=h.widths;c&&d&&n(c,d,u)}}else{this._reset();e(a[0])}}},a.prototype._toSVG=function(){var t=this,n=this._data,e=this._canvas,i=Math.max(window.devicePixelRatio||1,1),o=e.width/i,a=e.height/i,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"width",e.width),s.setAttributeNS(null,"height",e.height),this._fromData(n,function(t,n,e){var i=document.createElement("path");if(!(isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y))){var o="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3);i.setAttribute("d",o),i.setAttribute("stroke-width",(2.25*n.end).toFixed(3)),i.setAttribute("stroke",e),i.setAttribute("fill","none"),i.setAttribute("stroke-linecap","round"),s.appendChild(i)}},function(n){var e=document.createElement("circle"),i="function"==typeof t.dotSize?t.dotSize():t.dotSize;e.setAttribute("r",i),e.setAttribute("cx",n.x),e.setAttribute("cy",n.y),e.setAttribute("fill",n.color),s.appendChild(e)});var r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+o+" "+a+'" width="'+o+'" height="'+a+'">',l=s.innerHTML;if(void 0===l){var u=document.createElement("dummy"),h=s.childNodes;u.innerHTML="";for(var c=0;c<h.length;c+=1)u.appendChild(h[c].cloneNode(!0));l=u.innerHTML}var d=r+l+"</svg>";return"data:image/svg+xml;base64,"+btoa(d)},a.prototype.fromData=function(t){var n=this;this.clear(),this._fromData(t,function(t,e){return n._drawCurve(t,e.start,e.end)},function(t){return n._drawDot(t)}),this._data=t},a.prototype.toData=function(){return this._data},n.default=a}});