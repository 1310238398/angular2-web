{"version":3,"sources":["../../src/pages/uploadshetuan/activityend/activityend.module.ts","../../src/pages/uploadshetuan/activityend/activityend.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ActivityEndPage } from \"./activityend\";\n\n\nimport { SelectSearchableModule } from 'ionic-select-searchable';\n\n@NgModule({\n  declarations: [\n    ActivityEndPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ActivityEndPage),\n    SelectSearchableModule,\n  ],\n  entryComponents: [\n    ActivityEndPage,\n  ],\n  schemas: [\n    CUSTOM_ELEMENTS_SCHEMA\n  ]\n\n})\nexport class ActivityEndPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/uploadshetuan/activityend/activityend.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from \"ionic-angular\";\nimport { DomSanitizer } from \"@angular/platform-browser\";\nimport { ServelUrl } from \"../../../app/ServelUrl\";\nimport { HttpService } from \"../../../http/http.Service\";\nimport { HelpUtils } from \"../../../app/utils/HelpUtils\";\nimport * as EXIF from 'exif-js';\n\n\ndeclare var qiniu;\ndeclare var antlinker;\n\n@IonicPage()\n@Component({\n  selector: 'page-activityend',\n  templateUrl: 'activityend.html'\n})\nexport class ActivityEndPage {\n\n  values = 50;\n  numdisb = true;\n  temTitle = '辅导员(班主任)考核加分信息上报'\n  ActivityCode;\n  activitystatus;\n  UnionCode;\n  shetuanstatus;\n  LeaveApply = {\n    Activity: '',\n    Info: '',\n    endinfo: ''\n  }\n\n\n  item = {\n    code: '',\n    memo: '',\n    name: '',\n    record_id: ''\n  };\n\n\n  fileLoading;\n  CertifyImgs = [];\n  RecordIdArr = [] //存储后台返回的RecordID\n\n  displayTxt = '取消';\n  TaskTime = this.nowDay();\n  subStop = false;\n\n  constructor(private navCtrl: NavController, private http: HttpService, private DomSanitizer: DomSanitizer, private HelpUtils: HelpUtils, public navParams: NavParams, private DomS: DomSanitizer) {\n    this.ActivityCode = this.navParams.get('ActivityCode');\n    this.activitystatus = this.navParams.get('activitystatus');\n    this.UnionCode = this.navParams.get('UnionCode');\n    this.shetuanstatus = this.navParams.get('shetuanstatus');\n\n\n  }\n\n  //初始化加载\n  ionViewWillEnter() {\n    antlinker.configTitle({\n      type: \"label\",\n      title: \"社团活动\",\n      fail: function () { },\n      success: function () { }\n    });\n    // 右上角按钮\n    antlinker.configTitleButton({\n      showClose: true,\n      type: \"label\",\n      text: \"\",\n      success: function () { },\n      fail: function () { },\n      trigger: function () { }\n    });\n  }\n\n  //初始化加载\n  ionViewDidEnter() {\n    this.getactivityinfo();\n\n  }\n\n\n  //总提交\n  tabAlert() {\n\n    if (this.LeaveApply.Activity.trim() == '') {\n      this.HelpUtils.toastPopTop('请输入活动名称');\n      return false\n    }\n    if (!this.LeaveApply.Info) {\n      this.HelpUtils.toastPopTop('请填写活动内容');\n      return false\n    }\n    if (!this.LeaveApply.endinfo) {\n      this.HelpUtils.toastPopTop('请填写活动总结');\n      return false\n    }\n\n    var RecordIdString = this.RecordIdArr.join(',')\n\n    if (!RecordIdString) {\n      this.HelpUtils.toastPopTop('请上传图片');\n      return false\n    }\n\n    this.subStop = true;\n\n    this.http.postJSON({\n      Router: ServelUrl.Url.updateactivityend,\n      Method: 'POST',\n      Body: {\n        Status: this.activitystatus,      //status\n        Code: this.ActivityCode,                 // 活动code\n        Name: this.LeaveApply.Activity,             // 活动名称\n        Info: this.LeaveApply.Info,             // 活动内容\n        End: this.LeaveApply.endinfo,             // 活动总结\n        AttachmentCode: RecordIdString,           // 活动总结图片\n        Scode: this.UnionCode                    // 社团活动code为unionstatus表服务\n\n      }\n    }).then(res => {\n      if (!res.FeedbackCode) {\n        this.HelpUtils.toastPopTop('社团活动+1');\n        const that = this;\n        setTimeout(function () {\n          that.navCtrl.push('ShetuanInfoPage', {\n            UnionCode: this.UnionCode,\n            shetuanstatus: this.shetuanstatus\n          });\n        }, 1000);\n      } else {\n        this.subStop = false;\n        this.HelpUtils.toastPopTop(res);\n      }\n    },\n      err => console.log(err)\n    );\n\n  }\n\n  //======七牛上传\n\n  upload(obj) {\n\n    this.fileLoading = this.HelpUtils.loadingPop('正在上传，请稍等...');\n\n    var that = this;\n    var observable = qiniu.upload(obj.file, obj.key, obj.token, {\n      mimeType: [\"image/png\", \"image/jpeg\", \"image/jpg\"]\n    }, {\n        useCdnDomain: true\n      });\n    var observer = {\n      next(res) {\n        console.log(res)\n        // ...\n      },\n      error(err) {\n        that.HelpUtils.toastPop(err.message);\n        return false\n        // ...\n      },\n      complete(res) {\n        var file = obj.file;\n        that.fileLoading.dismiss();\n\n        that.http.postJSON({\n          Router: ServelUrl.Url.saveAttach, Method: 'POST', Body: {\n            BizType: 'StudentNeedSupport',\n            AttachmentItemName: file.name || '',\n            AttachmentItemType: file.type,\n            AttachmentItemSize: file.size.toString(),\n            AttachmentURL: res.key,\n            Base64: '',\n          }\n        }).then(response => {\n          if (!response.FeedbackCode) {\n            that.RecordIdArr.push(response.Data.RecordID);\n            that.CertifyImgs.push({\n              RecordID: response.Data.RecordID,\n              Caption: '',\t//字符串\t说明\n              AttachmentURL: window.URL.createObjectURL(file),\n              AttachmentItemSize: file.size.toString(),\n              AttachmentItemType: file.type,\n              AttachmentItemName: file.name,\n            });\n\n          } else {\n            that.HelpUtils.toastPop(response.FeedbackText);\n          }\n          console.log(res);\n        })\n      }\n    };\n    var subscription = observable.subscribe(observer); // 上传开始\n  }\n\n  handleFiles(event) {\n    var file = event.target.files[0];\n\n    console.log(file.size, '11111111111')\n\n    if (file.size > 5242880) {\n      this.HelpUtils.toastPop('文件大小限制:5M');\n      return\n    }\n    if (file.type != 'image/png' && file.type != 'image/jpeg' && file.type != 'image/jpg') {\n      this.HelpUtils.toastPop('格式错误,请选择\"png,jpeg,jpg\"格式文件上传');\n      return\n    }\n    this.http.postJSON({\n      Router: ServelUrl.Url.getUpToken,\n      Method: 'POST',\n      Body: {\n        Name: file.name,\n        Size: file.size,\n        BizType: \"SchoolApply\"\n      }\n    }).then(res => {\n      if (!res.FeedbackCode) {\n        this.upload({ file: file, key: res.Data.Key, token: res.Data.Proof })\n      } else if (res.FeedbackText == '获取上传KEY有误，请稍后重试') {\n        this.HelpUtils.toastPopTop('图片错误,请重新选择其他图片上传');\n      } else {\n        this.HelpUtils.toastPopTop(res.FeedbackText);\n      }\n    })\n  }\n\n  //获取上传文件后缀名\n  getFileExtension(filename) {\n    return filename.slice((filename.lastIndexOf('.') - 1 >>> 0) + 2);\n  }\n\n  //删除附件\n  deleteCertify(event, index) {\n    this.CertifyImgs.splice(index, 1);\n    this.RecordIdArr.splice(index, 1);\n    event.stopPropagation();\n  }\n\n\n  //备注框字数变化\n  // txtChange(value: string) {\n  //   var valueTxt = value.trim();\n  //   this.values = 50 - valueTxt.length;\n  //   if (this.values != 50) {\n  //     this.subStop = false;\n  //   } else {\n  //     this.subStop = true;\n  //   }\n  // }\n\n\n\n  //获取当前时间\n  nowDay() {\n    const Dates = new Date();\n    const year: number = Dates.getFullYear();\n    const month: any = (Dates.getMonth() + 1) < 10 ? '0' + (Dates.getMonth() + 1) : (Dates.getMonth() + 1);\n    const day: any = Dates.getDate() < 10 ? '0' + Dates.getDate() : Dates.getDate();\n    return year + '-' + month + '-' + day\n  }\n\n  // 获取已提交的活动信息\n  getactivityinfo() {\n    console.log(4);\n    this.http.postJSON({\n      Router: ServelUrl.Url.getactivityinfo,\n      Method: 'POST',\n      Body: {\n        Uname: this.UnionCode,\n        Code: this.ActivityCode\n      }\n    }).then(res => {\n      if (!res.FeedbackCode) {\n        this.LeaveApply = res.Data;\n        console.log(this.LeaveApply);\n      } else {\n        this.HelpUtils.toastPopTop(res);\n      }\n    },\n      err => console.log(err)\n    );\n\n\n  }\n\n\n  ionViewWillLeave() {\n    var event = new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': true\n    });\n    var d = document.querySelector('ion-backdrop');\n    if (d) {\n      d.dispatchEvent(event)\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/uploadshetuan/activityend/activityend.ts"],"sourceRoot":""}