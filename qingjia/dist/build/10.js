webpackJsonp([10],{248:function(n,t,l){"use strict";function e(n){return a._22(0,[(n()(),a.Z(0,0,null,null,3,"div",[["class","waring"]],null,null,null,null,null)),(n()(),a.Z(1,0,null,null,1,"ion-icon",[["class","font"],["name","ios-alert-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),a.Y(2,147456,null,0,S.a,[A.a,a.j,a.z],{name:[0,"name"]},null),(n()(),a._20(-1,null,["定位未在学校范围内，请重新定位（请点击地图右下角图标）\n    或上传照片证明本人已到校"]))],function(n,t){n(t,2,0,"ios-alert-outline")},function(n,t){n(t,1,0,a._13(t,2)._hidden)})}function i(n){return a._22(0,[(n()(),a.Z(0,0,null,null,1,"span",[["class","info zhengming"]],null,null,null,null,null)),(n()(),a._20(-1,null,["最多可以上传三种，每张限制大小为3M"]))],null,null)}function o(n){return a._22(0,[(n()(),a.Z(0,0,null,null,6,"span",[["class","Certify"]],null,null,null,null,null)),(n()(),a._20(-1,null,["\n  "])),(n()(),a.Z(2,0,null,null,1,"ion-icon",[["class","delete"],["ios","ios-close-outline"],["md","md-close"],["role","img"]],[[2,"hide",null]],[[null,"click"]],function(n,t,l){var e=!0;if("click"===t){e=!1!==n.component.deleteCertify(l,n.context.index)&&e}return e},null,null)),a.Y(3,147456,null,0,S.a,[A.a,a.j,a.z],{ios:[0,"ios"],md:[1,"md"]},null),(n()(),a._20(-1,null,["\n  "])),(n()(),a.Z(5,0,null,null,0,"img",[],[[8,"src",4]],[[null,"click"]],function(n,t,l){var e=!0,i=n.component;if("click"===t){e=!1!==i.navPreview({time:!1,index:n.context.index,items:i.CertifyImgs})&&e}return e},null,null)),(n()(),a._20(-1,null,["\n"]))],function(n,t){n(t,3,0,"ios-close-outline","md-close")},function(n,t){var l=t.component;n(t,2,0,a._13(t,3)._hidden);n(t,5,0,l.DomSanitization.bypassSecurityTrustUrl(t.context.$implicit.url))})}function u(n){return a._22(0,[a._18(402653184,1,{mapElement:0}),(n()(),a.Z(1,0,null,null,28,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,M.b,M.a)),a.Y(2,4374528,null,0,L.a,[A.a,U.a,I.a,a.j,a.z,T.a,w.a,a.u,[2,D.a],[2,F.a]],null,null),(n()(),a._20(-1,1,["\n  "])),(n()(),a.Z(4,0,[[1,0],["containerMap",1]],1,0,"div",[["id","containerMap"],["style","width: 100%; height: 225px"]],null,null,null,null,null)),(n()(),a._20(-1,1,["\n  "])),(n()(),a.U(16777216,null,1,1,null,e)),a.Y(7,16384,null,0,O.i,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(n()(),a._20(-1,1,["\n"])),(n()(),a.Z(9,0,null,1,12,"div",[["class","upload"]],null,null,null,null,null)),(n()(),a._20(-1,null,["\n  "])),(n()(),a.Z(11,0,null,null,1,"div",[["class","zhengming"]],null,null,null,null,null)),(n()(),a._20(-1,null,["（可选）请上传照片：（部分请假材料或到校证明照片）"])),(n()(),a._20(-1,null,["\n    "])),(n()(),a.Z(14,0,null,null,0,"img",[["id","pickfilesImg"],["src","assets/images/add.png"]],null,null,null,null,null)),(n()(),a._20(-1,null,["\n  "])),(n()(),a.U(16777216,null,null,1,null,i)),a.Y(17,16384,null,0,O.i,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(n()(),a._20(-1,null,["\n"])),(n()(),a.U(16777216,null,null,1,null,o)),a.Y(20,802816,null,0,O.h,[a.I,a.F,a.p],{ngForOf:[0,"ngForOf"]},null),(n()(),a._20(-1,null,["\n"])),(n()(),a._20(-1,1,["\n  "])),(n()(),a.Z(23,0,null,1,5,"div",[["padding",""]],null,null,null,null,null)),(n()(),a._20(-1,null,["\n    "])),(n()(),a.Z(25,0,null,null,2,"button",[["block",""],["color","zj-main-color"],["ion-button",""]],null,[[null,"click"]],function(n,t,l){var e=!0;if("click"===t){e=!1!==n.component.onConfirmSubmit()&&e}return e},z.b,z.a)),a.Y(26,1097728,null,0,j.a,[[8,""],A.a,a.j,a.z],{color:[0,"color"],block:[1,"block"]},null),(n()(),a._20(-1,0,["确认位置并提交申请"])),(n()(),a._20(-1,null,["\n  "])),(n()(),a._20(-1,1,["\n"])),(n()(),a._20(-1,null,["\n"]))],function(n,t){var l=t.component;n(t,7,0,l.isWaring);n(t,17,0,!l.CertifyImgs.length);n(t,20,0,l.CertifyImgs);n(t,26,0,"zj-main-color","")},function(n,t){n(t,1,0,a._13(t,2).statusbarPadding,a._13(t,2)._hasRefresher)})}Object.defineProperty(t,"__esModule",{value:!0});var a=l(0),s=(l(7),l(70),l(50)),r=l(51),c=l(254),p=l(110),h=l(31),d=function(){function n(n,t,l,e,i,o,u){var a=this;this.loadingCtrl=n,this.DomSanitization=t,this.navCtrl=l,this.http=e,this.params=i,this.HelpUtils=o,this.isDisabled=!0,this.applyDate=(new Date).toISOString(),this.Certify={AttachmentKey:"",AttachmentCode:""},this.arriveSchool=!1,this.isWaring=!1,this.SchoolPath=[117.131944,36.673466],this.CertifyImgs=[],this.currentPosition=[],this.UserInfo={Name:"",UserCode:"",AcademyName:"",ClassName:"",applyDate:""},u.getSchoolLocation().then(function(n){a.SchoolPath=n.Data.LocationCenter.split(","),a.SchoolRadius=n.Data.LocationRadius}),this.TaskCode=this.params.get("TaskCode")}return n.prototype.ionViewWillEnter=function(){antlinker.configTitle({type:"label",title:"销假列表",fail:function(){},success:""}),antlinker.configTitleButton({showClose:!0,type:"empty",success:"",fail:function(){}})},n.prototype.initQiniu=function(){var n=this;this.uploader=Qiniu.uploader({runtimes:"html5,flash,html4",browse_button:"pickfilesImg",domain:"http://qiniu-plupload.qiniudn.com/",uptoken_func:function(t){var l="";return n.http.postXhr({Router:p.a.Url.getUpToken,Method:"POST",Body:{Name:t.name,Size:t.size,BizType:"LeaveApplication"}},function(t){t.Data&&t.Data.Proof&&(n.Certify.AttachmentKey=t.Data.Key||"",n.Certify.AttachmentCode=t.Data.AttachmentCode||"",l=""+t.Data.Proof)}),l},filters:{max_file_size:"3mb",prevent_duplicates:!0,mime_types:[{title:"Image files",extensions:"jpg,gif,png"}]},save_key:!1,disable_statistics_report:!0,unique_names:!1,get_new_uptoken:!0,max_file_size:"3mb",max_retries:3,log_level:5,flash_swf_url:"assets/lib/Moxie.swf",multi_selection:!1,dragdrop:!1,chunk_size:"3mb",auto_start:!0,resize:{quality:60},init:{Key:function(t,l){return n.Certify.AttachmentKey||""},FilesAdded:function(t,l){n.CertifyImgs.length>=3?(t.splice(),n.HelpUtils.alert("证明材料最多可选择三张")):(n.fileLoading=n.loadingCtrl.create({content:"正在上传，请稍等..."}),n.fileLoading.present())},BeforeUpload:function(n,t){},UploadProgress:function(n,t){},FileUploaded:function(t,l,e){console.log(moment(l.getNative().lastModifiedDate).format("YYYY-MM-DD HH:mm"));var i=Object.assign({url:window.URL.createObjectURL(l.getNative()),AttachmentTime:moment(l.getNative().lastModifiedDate).format("YYYY-MM-DD HH:mm")},n.Certify);n.CertifyImgs.push(i)},UploadComplete:function(){n.fileLoading.dismiss()},Error:function(t,l,e){console.log(l),"-600"==l.code&&n.HelpUtils.toastPop("文件过大，最大为3M!")}}})},n.prototype.ionViewDidLoad=function(){var n,t=this;this.map=new AMap.Map(this.mapElement.nativeElement,{resizeEnable:!0}),this.map.plugin("AMap.Geolocation",function(){n=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"}),t.map.addControl(n),n.getCurrentPosition(),AMap.event.addListener(n,"complete",function(n){t.currentPosition=[],t.currentPosition.push(n.position.getLng()),t.currentPosition.push(n.position.getLat()),console.log(t.currentPosition),t.isDisabled=!1;var l=["定位成功"];l.push("经度："+n.position.getLng()),l.push("纬度："+n.position.getLat()),l.push("精度："+n.accuracy+" 米"),l.push("是否经过偏移："+(n.isConverted?"是":"否")),console.log(l.join("<br>"));var e=new AMap.Circle({map:t.map,center:t.SchoolPath,radius:t.SchoolRadius,strokeColor:"#F33",strokeOpacity:1,strokeWeight:3,fillColor:"#ee2200",fillOpacity:.35});t.map.setFitView(),e.contains(t.currentPosition)&&(t.arriveSchool=!0)}),AMap.event.addListener(n,"error",function(n){t.isWaring=!0})}),this.initQiniu()},n.prototype.onConfirmSubmit=function(){if(this.isWaring=!1,console.log(this.currentPosition),2==this.currentPosition.length)if(this.arriveSchool)this.applyXiaojia({TaskCode:this.TaskCode,Location:this.currentPosition.join(),Attachs:this.CertifyImgs||[]});else{if(!this.CertifyImgs.length)return void(this.isWaring=!0);this.applyXiaojia({TaskCode:this.TaskCode,Location:"",Attachs:this.CertifyImgs||[]})}else{if(this.isWaring=!0,!this.CertifyImgs.length)return void this.HelpUtils.toastPop("尚未定位到学校范围，请上传证明材料！");this.applyXiaojia({TaskCode:this.TaskCode,Location:"",Attachs:this.CertifyImgs||[]})}},n.prototype.applyXiaojia=function(n){var t=this;this.http.postJSON({Router:p.a.Url.recallapply,Method:"POST",Body:n}).then(function(n){n.FeedbackCode||(t.HelpUtils.toastPop("销假申请已提交，已放入销假列表中！"),t.navCtrl.push("ListPage"))})},n.prototype.deleteCertify=function(n,t){this.CertifyImgs.splice(t),n.stopPropagation()},n.prototype.navPreview=function(n){this.navCtrl.push("PreviewPage",n)},n}(),f=function(){return function(){}}(),m=l(187),g=l(188),_=l(189),y=l(190),C=l(191),v=l(192),b=l(193),P=l(194),k=l(195),S=l(39),A=l(1),M=l(253),L=l(21),U=l(3),I=l(9),T=l(8),w=l(34),D=l(4),F=l(20),O=l(13),z=l(38),j=l(19),x=l(76),R=l(10),Y=a.X({encapsulation:2,styles:[],data:{}}),Z=a.V("page-resume-leave-address",d,function(n){return a._22(0,[(n()(),a.Z(0,0,null,null,1,"page-resume-leave-address",[],null,null,null,u,Y)),a.Y(1,49152,null,0,d,[x.a,h.c,F.a,s.a,R.a,r.a,c.a],null,null)],null,null)},{},{},[]),N=l(16),B=l(111),H=l(35);l.d(t,"ResumeLeaveAddressPageModuleNgFactory",function(){return W});var W=a.W(f,[],function(n){return a._10([a._11(512,a.i,a.S,[[8,[m.a,g.a,_.a,y.a,C.a,v.a,b.a,P.a,k.a,Z]],[3,a.i],a.s]),a._11(4608,O.k,O.j,[a.r,[2,O.s]]),a._11(4608,N.r,N.r,[]),a._11(4608,N.d,N.d,[]),a._11(4608,c.a,c.a,[s.a]),a._11(512,O.b,O.b,[]),a._11(512,N.o,N.o,[]),a._11(512,N.g,N.g,[]),a._11(512,N.m,N.m,[]),a._11(512,B.a,B.a,[]),a._11(512,B.b,B.b,[]),a._11(512,f,f,[]),a._11(256,H.a,d,[])])})},253:function(n,t,l){"use strict";function e(n){return i._22(2,[i._18(402653184,1,{_fixedContent:0}),i._18(402653184,2,{_scrollContent:0}),(n()(),i.Z(2,0,[[1,0],["fixedContent",1]],null,1,"div",[["class","fixed-content"]],null,null,null,null,null)),i._12(null,0),(n()(),i.Z(4,0,[[2,0],["scrollContent",1]],null,1,"div",[["class","scroll-content"]],null,null,null,null,null)),i._12(null,1),i._12(null,2)],null,null)}l.d(t,"a",function(){return o}),t.b=e;var i=l(0),o=(l(21),l(1),l(3),l(9),l(34),l(4),l(20),i.X({encapsulation:2,styles:[],data:{}}))},254:function(n,t,l){"use strict";l.d(t,"a",function(){return i});l(7),l(50);var e=l(110),i=function(){function n(n){this.http=n,this.pushFlag=!1}return n.prototype.getPushFlag=function(){return this.pushFlag},n.prototype.setPushFlag=function(){this.pushFlag=!0},n.prototype.getUserInfo=function(){this.http.postJSON({Router:e.a.Url.queryleavestudentmessage,Method:"POST",Body:{}}).then(function(n){if(!n.FeedbackCode)return n})},n.prototype.getStudentApplyLocationAndAuthReason=function(n){return this.http.postJSON({Router:e.a.Url.QueryUserTaskReasonAndLocation,Method:"POST",Body:n}).then(function(n){if(!n.FeedbackCode)return n})},n.prototype.getSchoolLocation=function(){return this.http.postJSON({Router:e.a.Url.QueryCampusLocation,Method:"POST",Body:{}}).then(function(n){if(!n.FeedbackCode)return n})},n.prototype.getStudentLeaveApply=function(n){return this.http.postJSON({Router:e.a.Url.querystudentleaveapplication,Method:"POST",Body:n}).then(function(n){if(!n.FeedbackCode)return n})},n}()}});