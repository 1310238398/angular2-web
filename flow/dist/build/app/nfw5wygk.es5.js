/*! Built with http://stenciljs.com */
var __awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function s(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}l((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[0,o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};App.loadBundle("nfw5wygk",["exports","./chunk-666d0cc3.js","./chunk-e6612fa2.js","./chunk-dcb18ea7.js"],function(t,e,n,i){var o=window.App.h,r=function(){function t(){this.flowID="",this.recordID="",this.view="",this.doneItem=new i.DoneItem,this.formItem=new n.ApplyItem,this.createAction="create",this.doneAction="done"}return t.prototype.componentDidLoad=function(){var t=this.history.location.query;if(t)switch(this.view=t.view,this.view){case this.createAction:this.flowID=t.flow_id;break;case this.doneAction:this.recordID=t.record_id,this.fetchDone()}},t.prototype.fetchDone=function(){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(i){switch(i.label){case 0:return[4,e.util.loading()];case 1:return t=i.sent(),e.fetchFlowGet("/api/v1/flows/done/"+this.recordID).then(function(e){n.doneItem=e,n.formItem=JSON.parse(e.out_data),t.dismiss()}).catch(function(){t.dismiss(),e.util.alert("服务器发生错误")}),[2]}})})},t.prototype.handleSubmit=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(i){return this.view!==this.createAction?[2]:(t.preventDefault(),""===this.formItem.title?(e.util.alert("请输入申请标题"),[2]):""===this.formItem.content?(e.util.alert("请输入申请内容"),[2]):(e.util.confirm("确定提交吗？","提醒",function(){return __awaiter(n,void 0,void 0,function(){var t,n,i=this;return __generator(this,function(o){switch(o.label){case 0:return[4,e.util.loading("正在提交...")];case 1:return t=o.sent(),delete this.formItem.action,delete this.formItem.audit_comment,n=JSON.stringify(this.formItem),e.fetchFlowPost("/api/v1/flows/launch",{flow_id:this.flowID,form_data:n}).then(function(n){t.dismiss(),"ok"===n&&e.util.alert("提交成功","",function(){i.history.replace("/")})}).catch(function(){t.dismiss(),e.util.alert("服务器发生错误")}),[2]}})})}),[2]))})})},t.prototype.handleInputChange=function(t,e){switch(t){case"title":this.formItem.title=e.target.value;break;case"content":this.formItem.content=e.target.value;break;case"apply_date":this.formItem.apply_date=e.target.textContent}},t.prototype.renderSubmit=function(){if(this.view===this.createAction)return o("ion-button",{type:"submit",expand:"block",class:"form-submit"},"提 交")},t.prototype.render=function(){var t=this;return o("form",{class:"form",onSubmit:function(e){return t.handleSubmit(e)}},o("ion-list",null,o("ion-title",null,"通用申请"),o("ion-item",{lines:"inset"},o("ion-label",{position:"stacked",class:"form-item-required"},"申请标题"),o("ion-input",{readonly:this.view===this.doneAction,name:"title",type:"text",value:this.formItem.title,placeholder:"请输入标题",onIonChange:function(e){t.handleInputChange("title",e)}})),o("ion-item",{lines:"inset"},o("ion-label",{position:"stacked",class:"form-item-required"},"申请内容"),o("ion-textarea",{readonly:this.view===this.doneAction,value:this.formItem.content,placeholder:"请输入内容",onIonChange:function(e){t.handleInputChange("content",e)}})),o("ion-item",{lines:"inset"},o("ion-label",{position:"stacked",class:"form-item-required"},"申请日期"),o("ion-datetime",{disabled:this.view===this.doneAction,cancelText:"取消",doneText:"完成",displayFormat:"YYYY-MM-DD",min:"2010",max:"2020",value:this.formItem.apply_date,style:{"margin-left":"10px"},onIonStyle:function(e){t.handleInputChange("apply_date",e)}})),this.renderSubmit()))},Object.defineProperty(t,"is",{get:function(){return"app-apply-launch"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{doneItem:{state:!0},flowID:{state:!0},formItem:{state:!0},history:{type:"Any",attr:"history"},recordID:{state:!0},view:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return".form{padding:5px}.form-submit{margin-top:10px}.item-input-has-focus.item-input-has-value .input-clear-icon{display:none!important}.list-md .item-input.item-input-has-focus:last-child{-webkit-box-shadow:inset 0 0 0 0 var(--ion-color-md-primary,var(--ion-color-primary,#3880ff));box-shadow:inset 0 0 0 0 var(--ion-color-md-primary,var(--ion-color-primary,#3880ff))}"},enumerable:!0,configurable:!0}),t}();t.AppApplyLaunch=r,Object.defineProperty(t,"__esModule",{value:!0})});